{"version":3,"sources":["file:///D:/game/FrameworkCocos/assets/vd-games/preschool-exam/script/screens/comparison/level3_comp.ts"],"names":["_decorator","Component","Node","Prefab","log","tween","v3","Label","Button","UIOpacity","VDScreenManager","LocalDataManager","level_progress_bar","ccclass","property","level3_comp","type","canPick","levelNumber","sum","idItemSelected1","idItemSelected2","start","startPlay","lev","level","getComponent","string","Number","i","listQuestions","length","on","EventType","TOUCH_START","checkSelected1","bind","listAnswers","checkSelected2","onClickBtnBack","instance","popToRootScreen","onClickInstruction","checkQuestion","cancelSelect1","handleWrong","checkAnswer","cancelSelect2","onEnable","opacity","handleSelectedCorrect","active","onDisable","handleCorrectAll","cryIcon","setScale","to","scale","call","obCheck","getObject","currentLevel","match","levelBarUI","handleProgress","setObject","handleShowPopupNext","fireWork","showPopupNext","showPopupFromPrefabName","popup","popupWin","finishedCallback","level2_screen","assetBundle","get","String","pushScreen","screen","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Prefab, log, Sprite, tween, v3, Label, Button, UIOpacity } from 'cc';\r\nimport VDBasePopup from '../../../../../vd-framework/ui/VDBasePopup';\r\nimport VDBaseScreen from '../../../../../vd-framework/ui/VDBaseScreen';\r\nimport VDScreenManager from '../../../../../vd-framework/ui/VDScreenManager';\r\nimport LocalDataManager from '../../common/LocalDataManager';\r\nimport { popup_next } from '../../popups/popup_next';\r\nimport { level_progress_bar } from '../../transiton/level_progress_bar';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('level3_comp')\r\nexport class level3_comp extends Component {\r\n\r\n    @property({type: Node})\r\n    listQuestions: Node[] = [];\r\n    @property({type: Node})\r\n    listAnswers: Node[] = [];\r\n    @property(level_progress_bar)\r\n    levelBarUI: level_progress_bar = null;\r\n    @property({type: Node})\r\n    level: Node = null;\r\n    @property({type: Node})\r\n    fireWork: Node = null;\r\n    @property({type: Node})\r\n    cryIcon: Node = null;\r\n\r\n    private canPick = true;\r\n    private levelNumber = 1;\r\n    private sum = 0;\r\n    private idItemSelected1 = null;\r\n    private idItemSelected2 = null;\r\n    \r\n    start() {\r\n        this.startPlay();\r\n    }\r\n\r\n    startPlay(){\r\n        if(this.canPick) {\r\n            let lev = this.level.getComponent(Label).string;\r\n            this.levelNumber = Number(lev);\r\n            for(let i=0; i<this.listQuestions.length; i++){\r\n                this.listQuestions[i].on(Node.EventType.TOUCH_START, this.checkSelected1.bind(this, i));\r\n                this.listAnswers[i].on(Node.EventType.TOUCH_START, this.checkSelected2.bind(this, i));\r\n            }  \r\n        }\r\n    }\r\n    onClickBtnBack() {\r\n        VDScreenManager.instance.popToRootScreen(true);\r\n    }\r\n    onClickInstruction() {\r\n        log(\"start instruction\");\r\n    }\r\n    checkSelected1(i: number){\r\n        // khong the chon 2 cung mot the loai;\r\n        if(this.idItemSelected1==null){\r\n            this.idItemSelected1 = i;\r\n            this.checkQuestion(i);\r\n        }else if(i===this.idItemSelected1){\r\n            this.idItemSelected1=null;\r\n            this.cancelSelect1(i);\r\n        }else{\r\n            this.handleWrong();\r\n            this.cancelSelect1(i);\r\n            this.cancelSelect1(this.idItemSelected1);\r\n            this.idItemSelected1=null;\r\n        }\r\n    }\r\n    \r\n    checkSelected2(i: number){\r\n        if(this.idItemSelected2==null){\r\n            this.idItemSelected2 = i;\r\n            this.checkAnswer(i);\r\n        }else if(i===this.idItemSelected2){\r\n            this.idItemSelected2=null;\r\n            this.cancelSelect2(i);\r\n        }else{\r\n            this.handleWrong();\r\n            this.cancelSelect2(i);\r\n            this.cancelSelect2(this.idItemSelected2);\r\n            this.idItemSelected2=null;\r\n        }\r\n    }\r\n    cancelSelect1(i: number){\r\n        this.listQuestions[i].getComponent(Button).onEnable();\r\n        this.listQuestions[i].getComponent(UIOpacity).opacity = 255;\r\n    }\r\n    cancelSelect2(i: number){\r\n        this.listAnswers[i].getComponent(Button).onEnable();\r\n        this.listAnswers[i].getComponent(UIOpacity).opacity = 255;\r\n    }\r\n    handleSelectedCorrect(i: number){\r\n        this.listQuestions[i].active = false;\r\n        this.listAnswers[i].active = false;\r\n    }\r\n    checkQuestion(i: number){\r\n        this.listQuestions[i].getComponent(Button).onDisable();\r\n        this.listQuestions[i].getComponent(UIOpacity).opacity = 100;\r\n        if(this.idItemSelected2!=null){\r\n            if(this.idItemSelected2===i){\r\n                this.sum++;\r\n                this.handleSelectedCorrect(i);\r\n                if(this.sum===this.listAnswers.length){\r\n                    this.handleCorrectAll();\r\n                }\r\n            }else{\r\n                this.handleWrong();\r\n                this.cancelSelect1(this.idItemSelected1);\r\n                this.cancelSelect2(this.idItemSelected2);\r\n            }\r\n            this.idItemSelected1 = null;\r\n            this.idItemSelected2 = null;\r\n        }\r\n    }\r\n    checkAnswer(i: number){\r\n        this.listAnswers[i].getComponent(Button).onDisable();\r\n        this.listAnswers[i].getComponent(UIOpacity).opacity = 100;\r\n        if(this.idItemSelected1!=null){\r\n            if(this.idItemSelected1===i){\r\n                this.sum++;\r\n                this.handleSelectedCorrect(i);\r\n                if(this.sum===this.listAnswers.length){\r\n                    this.handleCorrectAll();\r\n                }\r\n            }else{\r\n                this.handleWrong();\r\n                this.cancelSelect1(this.idItemSelected1);\r\n                this.cancelSelect2(this.idItemSelected2);\r\n            }\r\n            this.idItemSelected1 = null;\r\n            this.idItemSelected2 = null;\r\n        }\r\n    }\r\n    handleWrong(){\r\n        this.cryIcon.active = true;\r\n        this.cryIcon.setScale(v3(0.001, 0.001, 0));\r\n        tween(this.cryIcon)\r\n        .to(2, {scale: v3(0.08, 0.08, 0)})\r\n        .call(()=>{\r\n            this.cryIcon.active = false;\r\n        })\r\n        .start();\r\n    }\r\n    handleCorrectAll(){\r\n        let obCheck = LocalDataManager.getObject(\"check\", {});\r\n        let currentLevel = obCheck.match[this.levelNumber+1];\r\n        if(!currentLevel) {\r\n            this.levelBarUI.handleProgress();\r\n        }\r\n        obCheck.match[this.levelNumber+1] = true;\r\n        LocalDataManager.setObject(\"check\", obCheck);\r\n        this.handleShowPopupNext();\r\n    }\r\n    handleShowPopupNext(){\r\n        this.fireWork.active = true;\r\n        this.fireWork.setScale(v3(0.1, 0.1, 0));\r\n        tween(this.fireWork)\r\n        .to(3, {scale: v3(1, 1, 0)})\r\n        .call(()=> {\r\n            this.showPopupNext();\r\n        })\r\n        .call(()=>{\r\n            this.fireWork.active = false;\r\n        })\r\n        .start();\r\n    }\r\n    showPopupNext(){\r\n        log(\"check\", this.levelNumber);\r\n        VDScreenManager.instance.showPopupFromPrefabName(\"res/prefabs/popup/popup_next\", (popup: VDBasePopup) => {\r\n            let popupWin = popup as popup_next;\r\n            // dinh nghia finshedCallBack chua goi nó\r\n            popupWin.finishedCallback = () => {\r\n                let level2_screen = VDScreenManager.instance.assetBundle.get('res/prefabs/screen/match/level'+String(this.levelNumber+1), Prefab)!;\r\n                VDScreenManager.instance.pushScreen(level2_screen, (screen: VDBaseScreen) => { }, true); \r\n            };\r\n        }, false, true, true);\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n}\r\n\r\n\r\n"]}