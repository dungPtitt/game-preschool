{"version":3,"sources":["file:///D:/game/FrameworkCocos/assets/vd-framework/ui/VDScrollBar.ts"],"names":["VDScrollView","ccclass","property","type","cc","_decorator","BAR_LINE_HEIGHT","VDScrollBarDirection","VDScrollBar","Sprite","Enum","Component","onLoad","scrollView","direction","bar","HORIZONTAL","VERTICAL","onEnable","node","on","updateBackground","onDisable","off","start","getComponent","UITransform","height","width","x","anchorX","getScale","y","anchorY","setPosition","angle","updateScrollBar","factor","Math","min","content"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACOA,MAAAA,Y;;;;;;;;OAGD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BC,EAAE,CAACC,U;AAEnCC,MAAAA,e,GAAkB,E;;iBAEVC,oB;AAAAA,QAAAA,oB,CAAAA,oB;AAAAA,QAAAA,oB,CAAAA,oB;SAAAA,oB,oCAAAA,oB;;yBAMSC,W,WAEhBN,QAAQ,CAACE,EAAE,CAACK,MAAJ,C,UAGRP,QAAQ;AAAA;AAAA,uC,UAGRA,QAAQ,CAAC;AACNC,QAAAA,IAAI,EAAEC,EAAE,CAACM,IAAH,CAAQH,oBAAR;AADA,OAAD,C,EATZN,O,qBAAD,MACqBO,WADrB,SACyCJ,EAAE,CAACO,SAD5C,CACsD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAalDC,QAAAA,MAAM,GAAG;AACL,cAAI,KAAKC,UAAL,IAAmB,CAAC,KAAKC,SAAL,GAAiB,KAAKD,UAAL,CAAgBC,SAAlC,KAAgD,CAAnE,IAAwE,KAAKC,GAA7E,KAAqF,KAAKD,SAAL,IAAkBP,oBAAoB,CAACS,UAAvC,IAAqD,KAAKF,SAAL,IAAkBP,oBAAoB,CAACU,QAAjL,CAAJ,EAAgM,CAE/L,CAFD,MAEO;AACH,kBAAM,8CAAN;AACH;AACJ;;AAEDC,QAAAA,QAAQ,GAAG;AACP,eAAKC,IAAL,CAAUC,EAAV,CAAa,kBAAb,EAAiC,KAAKC,gBAAtC,EAAwD,IAAxD;AACA,eAAKF,IAAL,CAAUC,EAAV,CAAa,eAAb,EAA8B,KAAKC,gBAAnC,EAAqD,IAArD;AACA,eAAKF,IAAL,CAAUC,EAAV,CAAa,cAAb,EAA6B,KAAKC,gBAAlC,EAAoD,IAApD;AACA,eAAKF,IAAL,CAAUC,EAAV,CAAa,kBAAb,EAAiC,KAAKC,gBAAtC,EAAwD,IAAxD;AACH;;AAEDC,QAAAA,SAAS,GAAG;AACR,eAAKH,IAAL,CAAUI,GAAV,CAAc,kBAAd,EAAkC,KAAKF,gBAAvC,EAAyD,IAAzD;AACA,eAAKF,IAAL,CAAUI,GAAV,CAAc,eAAd,EAA+B,KAAKF,gBAApC,EAAsD,IAAtD;AACA,eAAKF,IAAL,CAAUI,GAAV,CAAc,cAAd,EAA8B,KAAKF,gBAAnC,EAAqD,IAArD;AACA,eAAKF,IAAL,CAAUI,GAAV,CAAc,kBAAd,EAAkC,KAAKF,gBAAvC,EAAyD,IAAzD;AACH;;AAEDG,QAAAA,KAAK,GAAG;AACJ,eAAKH,gBAAL;AACH;;AAEDA,QAAAA,gBAAgB,GAAG;AACf,cAAI,KAAKR,UAAT,EAAqB;AACjB,iBAAKM,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCC,MAAxC,GAAiD,KAAKd,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDC,MAApG;AACA,iBAAKR,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAAxC,GAAgDtB,eAAhD;;AAEA,gBAAI,KAAKQ,SAAL,IAAkBP,oBAAoB,CAACU,QAA3C,EAAqD;AACjD;AACA,kBAAIY,CAAC,GAAG,KAAKhB,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDE,KAAnD,IAA4D,IAAI,KAAKf,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDI,OAAnH,IAA+H,KAAKX,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAAxC,IAAiD,IAAI,KAAKT,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCI,OAA7F,IAAwG,KAAKX,IAAL,CAAUY,QAAV,GAAqBF,CAApQ;AACA,kBAAIG,CAAC,GAAG,KAAKnB,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDC,MAAnD,IAA6D,IAAI,KAAKd,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDO,OAApH,IAAgI,KAAKd,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCC,MAAxC,IAAkD,IAAI,KAAKR,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCO,OAA9F,IAAyG,KAAKd,IAAL,CAAUY,QAAV,GAAqBC,CAAtQ;AACA,mBAAKb,IAAL,CAAUe,WAAV,CAAsBL,CAAtB,EAAyBG,CAAzB;AACH,aALD,MAKO,IAAI,KAAKlB,SAAL,IAAkBP,oBAAoB,CAACS,UAA3C,EAAuD;AAC1D;AACA,mBAAKG,IAAL,CAAUgB,KAAV,GAAkB,EAAlB;;AACA,kBAAIN,EAAC,GAAG,KAAKhB,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDE,KAAnD,IAA4D,IAAI,KAAKf,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDI,OAAnH,IAA+H,KAAKX,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCC,MAAxC,IAAkD,IAAI,KAAKR,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCO,OAA9F,IAAyG,KAAKd,IAAL,CAAUY,QAAV,GAAqBC,CAArQ;;AACA,kBAAIA,EAAC,GAAG,CAAE,KAAKnB,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDC,MAArD,GAA8D,KAAKd,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDO,OAAjH,GAA4H,KAAKd,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAAxC,IAAiD,IAAI,KAAKT,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCI,OAA7F,IAAwG,KAAKX,IAAL,CAAUY,QAAV,GAAqBF,CAAjQ;;AACA,mBAAKV,IAAL,CAAUe,WAAV,CAAsBL,EAAtB,EAAyBG,EAAzB;AACH;;AACD,iBAAKI,eAAL;AACH;AACJ;;AAEDA,QAAAA,eAAe,GAAG;AACd,cAAIC,MAAM,GAAGC,IAAI,CAACC,GAAL,CAAS,KAAK1B,UAAL,CAAgBM,IAAhB,CAAqBM,YAArB,CAAkCrB,EAAE,CAACsB,WAArC,EAAmDC,MAAnD,GAA4D,KAAKd,UAAL,CAAgB2B,OAAhB,CAAwBf,YAAxB,CAAqCrB,EAAE,CAACsB,WAAxC,EAAsDC,MAA3H,EAAmI,CAAnI,CAAb,CADc,CAEd;;AACA,eAAKZ,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CC,MAA5C,GAAqDU,MAAM,GAAG,KAAKlB,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCC,MAAtG;AACA,eAAKZ,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CE,KAA5C,GAAoD,KAAKT,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAA5F;;AACA,cAAI,KAAKd,SAAL,IAAkBP,oBAAoB,CAACU,QAA3C,EAAqD;AACjD,gBAAIY,CAAC,GAAG,KAAKV,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAAxC,IAAiD,IAAI,KAAKT,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCI,OAA7F,IAAyG,KAAKf,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CE,KAA5C,IAAqD,IAAI,KAAKb,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CI,OAArG,IAAgH,KAAKf,GAAL,CAASI,IAAT,CAAcY,QAAd,GAAyBF,CAA1P;AACA,gBAAIG,CAAC,GAAG,KAAKb,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCE,KAAxC,IAAiD,IAAI,KAAKT,IAAL,CAAUM,YAAV,CAAuBrB,EAAE,CAACsB,WAA1B,EAAwCI,OAA7F,IAAyG,KAAKf,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CE,KAA5C,IAAqD,IAAI,KAAKb,GAAL,CAASI,IAAT,CAAcM,YAAd,CAA2BrB,EAAE,CAACsB,WAA9B,EAA4CI,OAArG,IAAgH,KAAKf,GAAL,CAASI,IAAT,CAAcY,QAAd,GAAyBF,CAA1P;AACA,iBAAKd,GAAL,CAASI,IAAT,CAAce,WAAd,CAA0BL,CAA1B,EAA6BG,CAA7B;AACH;AACJ;;AAtEiD,O;;;;;iBAGjC,I;;;;;;;iBAGU,I;;;;;;;iBAKOzB,oBAAoB,CAACU,Q","sourcesContent":["import * as cc from 'cc';\nimport VDScrollView from './VDScrollView';\n\n\nconst { ccclass, property, type } = cc._decorator;\n\nvar BAR_LINE_HEIGHT = 10;\n\nexport enum VDScrollBarDirection {\n    VERTICAL = 1,\n    HORIZONTAL = 2\n}\n\n@ccclass\nexport default class VDScrollBar extends cc.Component {\n\n    @property(cc.Sprite)\n    bar: cc.Sprite = null!;\n\n    @property(VDScrollView)\n    scrollView: VDScrollView = null!;\n\n    @property({\n        type: cc.Enum(VDScrollBarDirection)\n    })\n    direction: VDScrollBarDirection = VDScrollBarDirection.VERTICAL;\n\n    onLoad() {\n        if (this.scrollView && (this.direction & this.scrollView.direction) != 0 && this.bar && (this.direction == VDScrollBarDirection.HORIZONTAL || this.direction == VDScrollBarDirection.VERTICAL)) {\n\n        } else {\n            throw \"Scroll Bar init failed, check ui logic again\";\n        }\n    }\n\n    onEnable() {\n        this.node.on('position-changed', this.updateBackground, this);\n        this.node.on('scale-changed', this.updateBackground, this);\n        this.node.on('size-changed', this.updateBackground, this);\n        this.node.on('rotation-changed', this.updateBackground, this);\n    }\n\n    onDisable() {\n        this.node.off('position-changed', this.updateBackground, this);\n        this.node.off('scale-changed', this.updateBackground, this);\n        this.node.off('size-changed', this.updateBackground, this);\n        this.node.off('rotation-changed', this.updateBackground, this);\n    }\n\n    start() {\n        this.updateBackground();\n    }\n\n    updateBackground() {\n        if (this.scrollView) {\n            this.node.getComponent(cc.UITransform)!.height = this.scrollView.node.getComponent(cc.UITransform)!.height;\n            this.node.getComponent(cc.UITransform)!.width = BAR_LINE_HEIGHT;\n\n            if (this.direction == VDScrollBarDirection.VERTICAL) {\n                //set background position at the right of the view\n                let x = this.scrollView.node.getComponent(cc.UITransform)!.width * (1 - this.scrollView.node.getComponent(cc.UITransform)!.anchorX) - (this.node.getComponent(cc.UITransform)!.width * (1 - this.node.getComponent(cc.UITransform)!.anchorX) * this.node.getScale().x);\n                let y = this.scrollView.node.getComponent(cc.UITransform)!.height * (1 - this.scrollView.node.getComponent(cc.UITransform)!.anchorY) - (this.node.getComponent(cc.UITransform)!.height * (1 - this.node.getComponent(cc.UITransform)!.anchorY) * this.node.getScale().y);\n                this.node.setPosition(x, y);\n            } else if (this.direction == VDScrollBarDirection.HORIZONTAL) {\n                //set background position at the bottom of the view\n                this.node.angle = 90;\n                let x = this.scrollView.node.getComponent(cc.UITransform)!.width * (1 - this.scrollView.node.getComponent(cc.UITransform)!.anchorX) - (this.node.getComponent(cc.UITransform)!.height * (1 - this.node.getComponent(cc.UITransform)!.anchorY) * this.node.getScale().y);\n                let y = - this.scrollView.node.getComponent(cc.UITransform)!.height * this.scrollView.node.getComponent(cc.UITransform)!.anchorY + (this.node.getComponent(cc.UITransform)!.width * (1 - this.node.getComponent(cc.UITransform)!.anchorX) * this.node.getScale().x);\n                this.node.setPosition(x, y);\n            }\n            this.updateScrollBar();\n        }\n    }\n\n    updateScrollBar() {\n        let factor = Math.min(this.scrollView.node.getComponent(cc.UITransform)!.height / this.scrollView.content.getComponent(cc.UITransform)!.height, 1);\n        // let scrollRatio = this.\n        this.bar.node.getComponent(cc.UITransform)!.height = factor * this.node.getComponent(cc.UITransform)!.height;\n        this.bar.node.getComponent(cc.UITransform)!.width = this.node.getComponent(cc.UITransform)!.width;\n        if (this.direction == VDScrollBarDirection.VERTICAL) {\n            let x = this.node.getComponent(cc.UITransform)!.width * (1 - this.node.getComponent(cc.UITransform)!.anchorX) - (this.bar.node.getComponent(cc.UITransform)!.width * (1 - this.bar.node.getComponent(cc.UITransform)!.anchorX) * this.bar.node.getScale().x);\n            let y = this.node.getComponent(cc.UITransform)!.width * (1 - this.node.getComponent(cc.UITransform)!.anchorX) - (this.bar.node.getComponent(cc.UITransform)!.width * (1 - this.bar.node.getComponent(cc.UITransform)!.anchorX) * this.bar.node.getScale().x);\n            this.bar.node.setPosition(x, y);\n        }\n    }\n}\n"]}