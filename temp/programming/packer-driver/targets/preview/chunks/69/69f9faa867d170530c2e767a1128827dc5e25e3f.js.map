{"version":3,"sources":["file:///C:/Users/Admin/Downloads/Telegram%20Desktop/FrameworkCocos/FrameworkCocos/assets/vd-framework/audio/VDAudioWebManager.ts"],"names":["VDAudioWebManager","log","game","Game","VDAudio","Audio","constructor","audios","_webBgm","_webClip","_sfx","_isActive","Howler","autoSuspend","autoUnlock","on","EVENT_HIDE","_onHideGame","EVENT_SHOW","_onShowGame","destroy","off","howl","stop","stopClip","stopAllEffects","length","_mutingMusic","pauseBGM","_mutingEffect","pauseClip","pauseAllEffects","resumeBGM","resumeClip","resumeAllEffects","init","audioList","key","h","Howl","src","data","path","playBGM","name","fade","musicPath","loop","isMutingMusic","play","volume","_musicVolume","FADE_DURATION","musicVolume","playing","pause","once","sId","playClip","callback","isMutingEffect","_effectVolume","playEffect","effectPath","sfxId","stopEffect","parseInt","stopEffectByName","soundIds","_getSoundIds","pauseEffect","resumeEffect","playingSoundIds","Object","keys","forEach","idSfx"],"mappings":"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","sourcesContent":["import { _decorator, log, game, Game } from 'cc';\nimport { VDAudio } from './VDAudio';\nimport Audio from '../plugins/howler.min.js';\n\nexport class VDAudioWebManager extends VDAudio {\n\n    public audios: { [key: string]: any } = {};\n\n    private _webBgm: any = null;\n    private _webClip: any = null;\n    private _sfx: { [name: string]: any } = {};\n    private _isActive: boolean = true;\n\n    constructor() {\n        super();\n        Audio.Howler.autoSuspend = false;\n        Audio.Howler.autoUnlock = true;\n        game.on(Game.EVENT_HIDE, this._onHideGame, this);\n        game.on(Game.EVENT_SHOW, this._onShowGame, this);\n    }\n\n    destroy() {\n        game.off(Game.EVENT_HIDE, this._onHideGame, this);\n        game.off(Game.EVENT_SHOW, this._onShowGame, this);\n\n        if (this._webBgm) {\n            this._webBgm.howl.stop();\n            this._webBgm = null;\n        }\n        this.stopClip();\n        this.stopAllEffects();\n\n        this.audios = {};\n        this._sfx.length = 0;\n    }\n\n    private _onHideGame() {\n        this._isActive = false;\n        if (!this._mutingMusic) {\n            this.pauseBGM();\n        }\n        if (!this._mutingEffect) {\n            this.pauseClip();\n            this.pauseAllEffects();\n        }\n    }\n\n    private _onShowGame() {\n        this._isActive = true;\n        if (!this._mutingMusic) {\n            this.resumeBGM();\n        }\n        if (!this._mutingEffect) {\n            this.resumeClip();\n            this.resumeAllEffects();\n        }\n    }\n\n    init(audioList: any) {\n        log(`initWebAudio`);\n\n        for (let key in audioList) {\n            let h = new Audio.Howl({ src: audioList[key] });\n            let data = {\n                path: audioList[key],\n                howl: h,\n            };\n            this.audios[key] = data;\n        }\n    }\n\n    playBGM(name: string, fade: boolean = false) {\n        if (!this._isActive) return;\n\n        let path = this.musicPath + name;\n        if (this._webBgm) {\n            this._webBgm.howl.stop();\n            this._webBgm = null;\n        }\n        let data = this.audios[path];\n        if (data && data.howl) {\n            data.howl.loop(true);\n            if (!this.isMutingMusic) {\n                data.howl.play();\n                if (fade) {\n                    data.howl.volume(0);\n                    data.howl.fade(0, this._musicVolume, VDAudio.FADE_DURATION * 1000);\n                }\n                else {\n                    data.howl.volume(this.musicVolume);\n                }\n            }\n            this._webBgm = data;\n        }\n    }\n\n    pauseBGM(fade = true) {\n        log(\"pauseBGM   Web\");\n        if (this._webBgm && this._webBgm.howl.playing()) {\n            if (!fade) {\n                this._webBgm.howl.pause();\n            }\n            else {\n                this._webBgm.howl.fade(this.musicVolume, 0, VDAudio.FADE_DURATION * 1000);\n                let howl = this._webBgm.howl;\n                howl.once('fade', (sId) => {\n                    howl.pause();\n                });\n            }\n        }\n    }\n\n    resumeBGM(fade = true) {\n        if (this.isMutingMusic) return;\n        log(\"resumeBGM   Web\");\n        if (this._webBgm && !this._webBgm.howl.playing()) {\n            if (!fade) {\n                this._webBgm.howl.volume(this._musicVolume);\n                this._webBgm.howl.play();\n            }\n            else {\n                this._webBgm.howl.play();\n                this._webBgm.howl.fade(0, this._musicVolume, VDAudio.FADE_DURATION * 1000);\n            }\n        }\n    }\n\n    playClip(name: string, loop: boolean = false, resumeBGM: boolean = true, callback: VoidFunction | null = null) {\n        if (!this._isActive) return;\n        if (this.isMutingEffect) return;\n\n        let path = this.musicPath + name;\n        if (this._webClip) {\n            this._webClip.howl.stop();\n            this._webClip = null;\n        }\n        let data = this.audios[path];\n        if (data && data.howl && !data.howl.playing()) {\n            this.pauseBGM();\n\n            data.howl.loop(loop);\n            data.howl.volume(this._effectVolume);\n            data.howl.play();\n            this._webClip = data;\n\n            !loop && this._webClip.howl.once('end', (sId) => {\n                if (resumeBGM) this.resumeBGM();\n                if (!loop && callback) callback();\n                this._webClip = null;\n            });\n        }\n    }\n\n    stopClip(resumeBGM: boolean = true, callback: VoidFunction | null = null) {\n        // let path = this.musicPath + name;\n        if (this._webClip && this._webClip.howl && this._webClip.howl.playing()) {\n            this._webClip.howl.fade(this._effectVolume, 0, VDAudio.FADE_DURATION * 1000);\n            let howl = this._webClip.howl;\n            howl.once('fade', (sId) => {\n                howl.stop();\n                this._webClip = null;\n                callback && callback();\n            });\n        }\n        if (resumeBGM) {\n            this.resumeBGM();\n        }\n    }\n\n    pauseClip(fade: boolean = false) {\n        if (this._webClip && this._webClip.howl && this._webClip.howl.playing()) {\n            if (!fade) {\n                this._webClip.howl.pause();\n            }\n            else {\n                this._webClip.howl.fade(this._effectVolume, 0, VDAudio.FADE_DURATION * 1000);\n                this._webClip.howl.once('fade', (sId) => {\n                    this._webClip.howl.pause();\n                });\n            }\n        }\n    }\n\n    resumeClip(fade: boolean = false) {\n        if (!this._isActive) return;\n        if (this._webClip && this._webClip.howl && !this._webClip.howl.playing()) {\n            if (!fade) {\n                this._webClip.howl.volume(this._effectVolume);\n                this._webClip.howl.play();\n            }\n            else {\n                this._webClip.howl.fade(0, this._effectVolume, VDAudio.FADE_DURATION * 1000);\n                this._webClip.howl.once('fade', (sId) => {\n                    this._webClip.howl.pause();\n                });\n            }\n        }\n    }\n\n    playEffect(name: string, loop: boolean = false, callback: VoidFunction | null = null): string | null {\n        if (!this._isActive) return;\n        if (this.isMutingEffect) return;\n\n        let path = this.effectPath + name;\n        let data = this.audios[path];\n        if (data && data.howl) {\n            data.howl.loop(loop);\n            data.howl.volume(this._effectVolume);\n            let sfxId = '' + data.howl.play();\n            this._sfx[sfxId] = data;\n            log(`playEffect Web start: ${path} - ${loop} - ${sfxId}`);\n\n            if (!loop) {\n                data.howl.once('end', (sId) => {\n                    log(`playEffect Web end : ${path}`);\n                    callback && callback();\n                    delete this._sfx[sfxId];\n                });\n            }\n            return sfxId;\n        }\n        return null;\n    }\n\n    stopEffect(sfxId: string, fade: boolean = false): boolean {\n        log(`Audio Web Manager stopEffect: ${sfxId}`);\n        let data = this._sfx[sfxId];\n        if (data && data.howl && data.howl.playing(parseInt(sfxId))) {\n            if (!fade) {\n                data.howl.stop(parseInt(sfxId));\n                delete this._sfx[sfxId];\n            }\n            else {\n                data.howl.fade(this._effectVolume, 0, VDAudio.FADE_DURATION * 1000, parseInt(sfxId));\n                data.howl.once('fade', (sId) => {\n                    data.howl.stop(parseInt(sfxId));\n                    delete this._sfx[sfxId];\n                })\n            }\n            return true;\n        }\n        return false;\n    }\n\n    stopEffectByName(name: string, fade: boolean = false): boolean {\n        let path = this.effectPath + name;\n        let data = this.audios[path];\n        log(`stopEffectByName: ${path}`);\n        if (data && data.howl && data.howl.playing()) {\n            if (!fade) {\n                data.howl.stop();\n            }\n            else {\n                data.howl.fade(this._effectVolume, 0, VDAudio.FADE_DURATION * 1000);\n                data.howl.once('fade', (sId) => {\n                    data.howl.stop();\n                });\n            }\n            let soundIds = data.howl._getSoundIds();\n            for (let sId of soundIds) {\n                delete this._sfx[sId + ''];\n            }\n            return true;\n        }\n        return false;\n    }\n\n    pauseEffect(sfxId: string, fade: boolean = false) {\n        log(`Audio Web Manager pauseEffect ${sfxId}`);\n        let data = this._sfx[sfxId];\n        if (data && data.howl && data.howl.playing(parseInt(sfxId))) {\n            log(`Audio Web Manager pauseEffect 222 ${sfxId}`);\n            if (!fade) {\n                data.howl.pause(parseInt(sfxId));\n            }\n            else {\n                data.howl.fade(this._effectVolume, 0, VDAudio.FADE_DURATION * 1000, parseInt(sfxId));\n                data.howl.once('fade', (sId) => {\n                    data.howl.pause(parseInt(sfxId));\n                });\n            }\n        }\n    }\n\n    resumeEffect(sfxId: string, fade: boolean = false) {\n        log(`Audio Manager resumeEffect ${sfxId}`);\n        let data = this._sfx[sfxId];\n        if (data && data.howl && !data.howl.playing(parseInt(sfxId))) {\n            if (!fade) {\n                data.howl.volume(this._effectVolume, parseInt(sfxId));\n                data.howl.play(parseInt(sfxId));\n            }\n            else {\n                data.howl.play(parseInt(sfxId));\n                data.howl.fade(0, this._effectVolume, VDAudio.FADE_DURATION * 1000, parseInt(sfxId));\n            }\n        }\n    }\n\n    stopAllEffects(fade: boolean = false) {\n        let playingSoundIds = Object.keys(this._sfx);\n        playingSoundIds.forEach(idSfx => {\n            this.stopEffect(idSfx, fade);\n        });\n    }\n\n    pauseAllEffects(fade: boolean = false) {\n        let playingSoundIds = Object.keys(this._sfx);\n        playingSoundIds.forEach(idSfx => {\n            this.pauseEffect(idSfx, fade);\n        });\n    }\n\n    resumeAllEffects(fade: boolean = false) {\n        let playingSoundIds = Object.keys(this._sfx);\n        playingSoundIds.forEach(idSfx => {\n            this.resumeEffect(idSfx, fade);\n        });\n    }\n\n}"]}