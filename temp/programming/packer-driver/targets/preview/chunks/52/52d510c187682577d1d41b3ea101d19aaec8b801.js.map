{"version":3,"sources":["file:///D:/game/FrameworkCocos/assets/vd-games/preschool-exam/script/screens/science/level1_science.ts"],"names":["_decorator","Component","Node","Graphics","v3","log","v2","ccclass","property","level1_science","graphics","rightP","leftP","startP","endP","answerP","questionP","endCurrentP","isDrawFirst","start","initGraphic","draw","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","getComponent","lineWidth","event","quesP","left","getWorldPosition","x","y","ansP","right","startPo","pStart","getUILocation","out","area","inverseTransformPoint","g","moveTo","stroke","newP","checkCorrect","lineTo","checkDrawFirst","dx","Math","abs","dy","clear","p","fireWork","active","update","deltaTime","clearDraw"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Graphics, EventTouch, v3, Vec3, log, Vec2, v2 } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('level1_science')\r\nexport class level1_science extends Component {\r\n    @property(Node)\r\n    left: Node = null;\r\n    @property(Node)\r\n    right: Node = null;\r\n    @property(Node)\r\n    area: Node = null;\r\n    @property(Node)\r\n    draw: Node = null;\r\n    @property(Node)\r\n    fireWork: Node = null;\r\n    private graphics: Graphics = null;\r\n    private rightP: Vec2;\r\n    private leftP: Vec2;\r\n    private startP: Vec2;\r\n    private endP: Vec2;\r\n    private answerP: Vec2;\r\n    private questionP: Vec2;\r\n\r\n    private endCurrentP: Vec2;\r\n    private isDrawFirst = true;\r\n    start() {\r\n        this.initGraphic();\r\n        ///lay vi tri cua dap an va cau hoi \r\n        // let quesP = this.left.getWorldPosition();\r\n        // this.questionP = v2(quesP.x, quesP.y);\r\n        // let ansP = this.right.getWorldPosition();\r\n        // this.answerP = v2(ansP.x, ansP.y);\r\n        ///\r\n        this.draw.on(Node.EventType.TOUCH_START, this.touchStart, this);\r\n        this.draw.on(Node.EventType.TOUCH_MOVE, this.touchMove, this);\r\n        this.draw.on(Node.EventType.TOUCH_END, this.touchEnd, this)\r\n    }\r\n    initGraphic(){\r\n        this.graphics = this.draw.getComponent(Graphics);\r\n        this.graphics.lineWidth = 10;\r\n\r\n        // let startP = this.left.getWorldPosition();\r\n        // let endP = this.right.getWorldPosition();\r\n        // log(\"check before\", endP, startP);\r\n        // this.rightP = v2(endP.x, endP.y);\r\n        // let g = this.graphics;\r\n        // g.moveTo(startP.x, startP.y);\r\n        // g.lineTo(startP.x+2, startP.y+2);\r\n        // g.stroke();\r\n    }\r\n    touchStart(event: EventTouch){\r\n        //phai lay trong nay moi dung\r\n        let quesP = this.left.getWorldPosition();\r\n        this.questionP = v2(quesP.x, quesP.y);\r\n        let ansP = this.right.getWorldPosition();\r\n        this.answerP = v2(ansP.x, ansP.y);\r\n        ///\r\n        let startPo = this.left.getWorldPosition();\r\n        let endP = this.right.getWorldPosition();\r\n        log(\"check before and after: \", startPo, this.questionP)\r\n        let pStart = event.getUILocation();\r\n        // this.startP = v2(startPo.x, startPo.y);\r\n        this.rightP = v2(endP.x, endP.y);\r\n        this.leftP = v2(startPo.x, startPo.y);\r\n        this.startP = v2(pStart.x, pStart.y);\r\n        log(\"check endP\", endP, startPo);\r\n        \r\n        let out = v3();\r\n        this.area.inverseTransformPoint(out, v3(pStart.x, pStart.y, 0));\r\n        let g = this.graphics;\r\n        g.moveTo(out.x, out.y);\r\n        g.stroke();\r\n    }\r\n\r\n    touchMove(event: EventTouch){\r\n        let newP = event.getUILocation();\r\n        this.checkCorrect(newP);\r\n        let out = v3();\r\n        this.area.inverseTransformPoint(out, v3(newP.x, newP.y, 0));\r\n        let g = this.graphics;\r\n        g.lineTo(out.x, out.y);\r\n        g.stroke();\r\n    }\r\n    touchEnd(event: EventTouch) {\r\n        let endP = event.getUILocation();\r\n        if(this.isDrawFirst){// lan dau ve\r\n            this.checkDrawFirst(endP);\r\n        }else {// nhung lan sau ve tu diem bi ngat\r\n            let dx = Math.abs(this.startP.x-this.leftP.x);\r\n            let dy = Math.abs(this.startP.y-this.leftP.y);\r\n            log(\"check touchend\", endP, this.leftP);\r\n            if(dx >= 40 || dy>=40) {\r\n                this.graphics.clear();\r\n                log(\"draw gain!!\");\r\n            }else{\r\n                //noi lien lai diem start\r\n                this.startP = v2(endP.x, endP.y);\r\n            }\r\n        }\r\n        \r\n    }\r\n    checkDrawFirst(endP: Vec2) {\r\n        let dx = Math.abs(this.startP.x-this.leftP.x);\r\n        let dy = Math.abs(this.startP.y-this.leftP.y);\r\n        log(\"check touchend\", endP, this.leftP);\r\n        if(dx >= 40 || dy>=40) {\r\n            this.graphics.clear();\r\n            log(\"draw gain!!\");\r\n        }else{\r\n            //noi lien lai diem start\r\n            this.startP = v2(endP.x, endP.y);\r\n        }\r\n    }\r\n    checkCorrect(p: Vec2){\r\n        log(\"check startP\", this.rightP, p);\r\n        let dx = Math.abs(p.x-this.rightP.x);\r\n        let dy = Math.abs(p.y-this.rightP.y);\r\n        if(dx <= 40 && dy<=40) {\r\n            this.fireWork.active = true;\r\n            log(\"correct!!!!!!!\");\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n    clearDraw(){\r\n        this.graphics.clear();\r\n    }\r\n}\r\n\r\n\r\n"]}